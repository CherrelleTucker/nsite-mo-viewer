<!-- MO-Viewer Navigation Component -->
<nav class="nav-bar">
  <!-- Primary Viewer Tabs -->
  <div class="nav-primary">
    <button type="button" class="nav-tab <?= activePage === branding.pages.page1.key ? 'active' : '' ?>"
            data-page="<?= branding.pages.page1.key ?>"
            onclick="navigateTo('<?= branding.pages.page1.key ?>')"
            title="<?= branding.pages.page1.name ?>">
      <span class="material-icons"><?= branding.pages.page1.icon ?></span>
      <span class="nav-label"><?= branding.pages.page1.name ?></span>
    </button>

    <button type="button" class="nav-tab <?= activePage === branding.pages.page2.key ? 'active' : '' ?>"
            data-page="<?= branding.pages.page2.key ?>"
            onclick="navigateTo('<?= branding.pages.page2.key ?>')"
            title="<?= branding.pages.page2.name ?>">
      <span class="material-icons"><?= branding.pages.page2.icon ?></span>
      <span class="nav-label"><?= branding.pages.page2.name ?></span>
    </button>

    <button type="button" class="nav-tab <?= activePage === branding.pages.page3.key ? 'active' : '' ?>"
            data-page="<?= branding.pages.page3.key ?>"
            onclick="navigateTo('<?= branding.pages.page3.key ?>')"
            title="<?= branding.pages.page3.name ?>">
      <span class="material-icons"><?= branding.pages.page3.icon ?></span>
      <span class="nav-label"><?= branding.pages.page3.name ?></span>
    </button>
  </div>

  <!-- Divider -->
  <div class="nav-divider"></div>

  <!-- Secondary Tabs -->
  <div class="nav-secondary">
    <button type="button" class="nav-tab <?= activePage === 'topsheet' ? 'active' : '' ?>"
            data-page="topsheet"
            onclick="navigateTo('topsheet')"
            title="Solution milestone top sheet">
      <span class="material-icons">table_chart</span>
      <span class="nav-label" style="<?= activePage === 'topsheet' ? '' : 'display:none' ?>">Top Sheet</span>
    </button>

    <button type="button" class="nav-tab <?= activePage === 'quick-update' ? 'active' : '' ?>"
            data-page="quick-update"
            onclick="navigateTo('quick-update')"
            title="Submit updates to meeting agendas">
      <span class="material-icons">edit</span>
      <span class="nav-label">Quick Update</span>
    </button>

    <button type="button" class="nav-tab <?= activePage === 'contacts' ? 'active' : '' ?>"
            data-page="contacts"
            onclick="navigateTo('contacts')"
            title="Browse solution contacts directory">
      <span class="material-icons">menu_book</span>
      <span class="nav-label">Contacts</span>
    </button>

    <button type="button" class="nav-tab <?= activePage === 'reports' ? 'active' : '' ?>"
            data-page="reports"
            onclick="navigateTo('reports')"
            title="Generate and view reports">
      <span class="material-icons">description</span>
      <span class="nav-label">Reports</span>
    </button>

    <button type="button" class="nav-tab <?= activePage === 'schedule' ? 'active' : '' ?>"
            data-page="schedule"
            onclick="navigateTo('schedule')"
            title="View solution milestones timeline">
      <span class="material-icons">calendar_today</span>
      <span class="nav-label">Schedule</span>
    </button>

    <button type="button" class="nav-tab <?= activePage === 'team' ? 'active' : '' ?>"
            data-page="team"
            onclick="navigateTo('team')"
            title="Team availability and meetings">
      <span class="material-icons">how_to_reg</span>
      <span class="nav-label">Team</span>
    </button>
  </div>

  <!-- Right side actions -->
  <div class="nav-actions">
    <button type="button" class="nav-icon-btn" id="refreshDataBtn"
            onclick="refreshAllData()"
            title="Refresh all data (clear cache)">
      <span class="material-icons">refresh</span>
    </button>
    <button type="button" class="nav-icon-btn <?= activePage === 'about' ? 'active' : '' ?>"
            data-page="about"
            onclick="navigateTo('about')"
            title="About this site">
      <span class="material-icons">info</span>
    </button>
  </div>
</nav>

<script>
  /**
   * Refresh all cached data and reload current page
   */
  function refreshAllData() {
    var btn = document.getElementById('refreshDataBtn');
    var icon = btn.querySelector('.material-icons');

    // Animate the refresh icon
    icon.style.animation = 'spin 1s linear infinite';
    btn.disabled = true;

    // Clear all caches
    if (typeof DataCache !== 'undefined') {
      DataCache.clearAll();
    }

    // Reload current page content
    var currentPage = Platform.activePage || 'implementation';

    google.script.run
      .withSuccessHandler(function(html) {
        setInnerHTMLWithScripts(document.getElementById('contentArea'), html);
        icon.style.animation = '';
        btn.disabled = false;
        showToast('Data refreshed', 'success', 2000);
      })
      .withFailureHandler(function(error) {
        icon.style.animation = '';
        btn.disabled = false;
        showToast('Refresh failed. Please try again.', 'error');
      })
      .getPageHTML(currentPage);
  }
</script>

<style>
  @keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }
</style>
